!-----------------------------------------------------------------------------
! (c) Crown copyright 2025 Met Office. All rights reserved.
! The file LICENCE, distributed with this code, contains details of the terms
! under which the code may be used.
!-----------------------------------------------------------------------------
!> @brief  Test the functionality of ffsl_advective_increment_kernel_mod

module ffsl_advective_increment_kernel_mod_test


  use constants_mod, only: i_def, r_tran, r_def
  use funit

  implicit none

  private
  public :: test_all

contains

  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  @Test
  subroutine test_all( )

    use ffsl_advective_increment_kernel_mod, only: ffsl_advective_increment_code

    implicit none

    real(kind=r_tran), parameter :: tol = 1.0e-12_r_tran
    real(kind=r_tran), parameter :: field = 589.4623_r_tran
    real(kind=r_tran), parameter :: one_over_dt = 7.531_r_tran
    real(kind=r_tran), parameter :: adv_one = 5.3891_r_tran

    real(kind=r_tran) :: increment
    real(kind=r_tran) :: answer

    increment = 1.56234_r_tran
    !answer = (increment + (adv_one - 1.0_r_tran)*field*one_over_dt)/adv_one
    answer = 3615.786156386749_r_tran

    call ffsl_advective_increment_code(increment,   &
                                       field,       &
                                       one_over_dt, &
                                       adv_one)

    @assertEqual(answer, increment, tol)

  end subroutine test_all

end module ffsl_advective_increment_kernel_mod_test
