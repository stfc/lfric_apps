[namelist:chemistry]
compulsory=true
description=Chemistry settings
ns=namelist/Science/UM Chemistry
sort-key=Section-A16
title=Chemistry

[namelist:chemistry=chem_scheme]
compulsory=true
description=Chemistry scheme
!enumeration=true
help=Choice of UKCA chemistry scheme
    =
    =Currently available schemes are:
    = 'Offline oxidants' which is the default scheme used
    =                    with GLOMAP_mode for proto-GAL
    = 'Strattrop' which is a full Stratosphere+Troposphere scheme
    = 'Strat_test' which only switches on selected components of Strattrop
    =               This will be retired when Strattrop is fully implemented.
    = 'flexchem' which is a flexible scheme for planetary atmospheres.
ns=namelist/Science/UM Chemistry
sort-key=Panel-A01
trigger=namelist:files=emiss_c2h6_ancil_path: 'strattrop', 'strat_test' ;
       =namelist:files=emiss_c3h8_ancil_path: 'strattrop', 'strat_test' ;
       =namelist:files=emiss_c5h8_ancil_path: 'strattrop', 'strat_test' ;
       =namelist:files=emiss_ch4_ancil_path: 'strattrop', 'strat_test' ;
       =namelist:files=emiss_co_ancil_path: 'strattrop', 'strat_test' ;
       =namelist:files=emiss_hcho_ancil_path: 'strattrop', 'strat_test' ;
       =namelist:files=emiss_me2co_ancil_path: 'strattrop', 'strat_test' ;
       =namelist:files=emiss_mecho_ancil_path: 'strattrop', 'strat_test' ;
       =namelist:files=emiss_meoh_ancil_path: 'strattrop', 'strat_test' ;
       =namelist:files=emiss_nh3_ancil_path: 'strattrop', 'strat_test' ;
       =namelist:files=emiss_no_aircrft_ancil_path: 'strattrop', 'strat_test' ;
       =namelist:files=emiss_no_ancil_path: 'strattrop', 'strat_test' ;
       =namelist:chemistry=l_ukca_ro2_ntp: 'strattrop', 'strat_test' ;
       =namelist:chemistry=l_ukca_asad_full: 'offline_ox', 'strattrop', 'strat_test' ;
       =namelist:chemistry=i_ukca_chem_version: 'offline_ox', 'strattrop', 'strat_test' ;
       =namelist:chemistry=l_ukca_quasinewton: 'strattrop', 'strat_test' ;
       =namelist:chemistry=top_bdy_opt: 'strattrop', 'strat_test' ;
       =namelist:chemistry=l_ukca_linox_scaling: 'strattrop', 'strat_test' ;
       =namelist:chemistry=flexchem_opt: 'flexchem';
       =namelist:chemistry=photol_scheme: 'strattrop', 'strat_test' ;
       =namelist:chemistry=chem_timestep: 'offline_ox', 'strattrop', 'strat_test' ;
value-titles=none,offline_ox,strattrop,strat_test,flexchem
values='none','offline_ox','strattrop','strat_test','flexchem'

[namelist:chemistry=chem_timestep]
compulsory=true
description=Chemistry timestep (seconds)
help=The UKCA chemical solver may not be called at every timestep
    = for all model configurations. chem_timestep is the timestep
    = for the chemistry solver, and determines the interval
    = between sucessive calls to the chemistry in units of
    = model timesteps. This chemical timestep affects the photolysis
    = and aerosol models as well as the chemical solver.
    =
    = The timestep is specified in seconds, and must be a multiple of the
    = model dynamical timestep
ns=namelist/Science/UM Chemistry
range=1:10800
sort-key=Panel-A02c
type=integer

[namelist:chemistry=fastjx_dir]
compulsory=true
description=Directory pathname for Fast-JX input files
help=Location of files containing the cross-section and scatterrer
    =data.
ns=namelist/Science/UM Chemistry
sort-key=Panel-A08a
type=character

[namelist:chemistry=fastjx_mode]
compulsory=true
description=Method above cut-off level
help=Above the cut off level there are 3 options:
    = 1: 'only lookup table'
    = 2: 'combination of Fast-JX and lookup tables'
    = 3: 'Fast-JX'
    = The recommended option is  to 'Use Lookup Tables' above a pressure
    = cut-off of 20 hPa.
ns=namelist/Science/UM Chemistry
sort-key=Panel-A07b
!type=integer
value-titles=only lookup table,Fast-JX and lookup table,Fast-JX only
values=1,2,3

[namelist:chemistry=fastjx_numwavel]
compulsory=true
description=Number of wavelengths to be used
help=It is possible to choose 8, 12 or 18 wavelength bins for Fast-JX.
    =The 18 wavelength version is the full Fast-JX version.
    =Choosing 12 is only suitable for troposphere only models
    =and drops cross sections for stratospheric species.
    =The 8 bin version is a fast troposphere only version.
    =The choice between the 8 and 12 bin versions is a trade off
    =between accuracy and speed.
ns=namelist/Science/UM Chemistry
sort-key=Panel-A07c
!type=integer
value-titles='8 wavelengths','12 wavelengths','18 wavelengths'
values=8,12,18

[namelist:chemistry=fastjx_prescutoff]
compulsory=true
description=Cut-off Pressure for tabulated photolysis
help=The "Cut-off Pressure for tabulated photolysis"
    = can be used to specify the pressure level (in Pascals -Pa) above
    = which a simplified look-up table approach can be used to compensate
    = for the lower wavelength limit of this scheme. The recommended
    = option is to 'Use Lookup Tables' above a pressure cut-off of 20 Pa.
ns=namelist/Science/UM Chemistry
range=0:9999.999
sort-key=Panel-A07c
type=real

[namelist:chemistry=fjx_scat_file]
compulsory=true
description=filename for Fast-JX scatterer file
help=Fast-JX scatterer file containing the required scatterer data.
ns=namelist/Science/UM Chemistry
sort-key=Panel-A08b
type=character

[namelist:chemistry=fjx_solar_file]
compulsory=true
description=filename for Fast-JX solar cycle file
help=Fast-JX spectral file containing the required solar cycle spectral
    =and time series data.
ns=namelist/Science/UM Chemistry
sort-key=Panel-A09b
type=character

[namelist:chemistry=fjx_solcyc_months]
compulsory=true
description=Months in solar cycle file
help=Number of months of data available in the fjx_solar_file
ns=namelist/Science/UM Chemistry
sort-key=Panel-A09c
type=integer

[namelist:chemistry=fjx_solcyc_type]
compulsory=true
description=Apply solar variability to photolysis scheme
help=This is available for Fast-JX, not the 2-D Photolysis scheme
    =(0) No solar cycle
    =(1) Solar flux follows an observed solar cycle from a
    =specified start year for a certain number months,
    =outside of these times repeated average cyle is used
    =(2) A repeated average cycle is used for all times.
ns=namelist/Science/UM Chemistry
sort-key=Panel-A09a
trigger=namelist:chemistry=fjx_solar_file: 1,2 ;
       =namelist:chemistry=fjx_solcyc_months: 1,2 ;
!type=integer
value-titles=no solar cycle,observed,average
values=0,1,2

[namelist:chemistry=fjx_spec_file]
compulsory=true
description=Filename for Fast-JX spectral file
help=Fast-JX spectral file containing the required cross-sections.
ns=namelist/Science/UM Chemistry
sort-key=Panel-A08c
type=character

[namelist:chemistry=flexchem_opt]
compulsory=true
description=Select option for flexible chemistry
!enumeration=true
help=Options:
    = - None (abundances prescribed by e.g. input files),
    = - Burrows & Sharp (1999, ApJ) analytic abundances for hot Jupiters,
ns=namelist/Science/UM Chemistry
sort-key=Panel-A03a
value-titles=none, Burrows & Sharp (1999)
values='none', 'bs1999'

[namelist:chemistry=i_chem_timestep_halvings]
compulsory=false
description=Number of halvings for ASAD chemistry timestep
fail-if=this < 0 or this > 5 ;
       =# number of chemistry timestep halvings must be between 0 and 5
help=The number of times the chemistry timestep chem_timestep value is halved
    = in UKCA's ASAD chemistry solver.
    =
    = For large values of ukca_chem_seg_size, setting a positive value of
    = i_chem_timestep_halvings can skip unnecessary calculations.
ns=namelist/Science/UM Chemistry
range=0:5
sort-key=Panel-A02c
type=integer

[namelist:chemistry=i_ukca_chem_version]
compulsory=true
description=Chemical mechanism version
help=This version number controls the values of the rates
    =and reactions used in ASAD-based chemical mechanisms.
ns=namelist/Science/UM Chemistry
range=107:
sort-key=Panel-A02b
type=integer

[namelist:chemistry=l_ukca_asad_full]
compulsory=true
description=Call ASAD chemical solver with the full domain
help=Use (True) to select passing full (MPI/ local) domain to the
    = ASAD N-R solver.
    = False will pass data as individual or group of columns.
ns=namelist/Science/UM Chemistry
sort-key=Panel-A02a
type=logical

[namelist:chemistry=l_ukca_linox_scaling]
compulsory=true
description=Equally distribute Lightning NOx emissions using LOG(p)
help=When True, this logical makes the UKCA Lightning NOx routine
    =redistribute the Lightning NOx emissions in the vertical
    =linearly using LOG(pressure) and uses the same NOx production
    =efficiency for cloud-to-ground and cloud-to-cloud flashes.
ns=namelist/Science/UM Chemistry
sort-key=Panel-A06a
trigger=namelist:chemistry=lightnox_scale_fac: true;
type=logical

[namelist:chemistry=l_ukca_quasinewton]
compulsory=true
description=Use quasi-Newton method in Newton-Raphson solver step
help=Controls use of quasi-Newton method during the ASAD (Newton-Raphson)
    =solver step to improve speed of convergence:
    =False for no scheme,
    =True for quasi-Newton Broyden method.
ns=namelist/Science/UM Chemistry
sort-key=Panel-A04
type=logical

[namelist:chemistry=l_ukca_ro2_ntp]
compulsory=true
description=To remove transport of RO2 tracers
help=if True, turns peroxy radical (RO2) in StratTrop to non-transported
    =variables instead of transported tracers
ns=namelist/Science/UM Chemistry
sort-key=Panel-A02
type=logical

[namelist:chemistry=lightnox_scale_fac]
compulsory=true
description=Lightning NOx emiss scale factor
help=Scaling factor for NOx emissions due to Lightning
ns=namelist/Science/UM Chemistry
range=0.0:
sort-key=Panel-A06b
type=real

[namelist:chemistry=photol_scheme]
compulsory=true
description=Photolysis scheme
!enumeration=true
help=Choice of UKCA photolysis scheme
    = Only available for 'Strattrop' Chemistry scheme currently.
    =Currently available schemes are:
    = 'Off': No photolysis scheme used
    = 'Prescribed': Use prescribed or 'pseudo' rates - as lodged at vn1.2
    = 'FastJX': Use the Fast-JX scheme
ns=namelist/Science/UM Chemistry
sort-key=Panel-A07a
trigger=namelist:chemistry=fastjx_mode: 'fastjx' ;
       =namelist:chemistry=fastjx_numwavel: 'fastjx' ;
       =namelist:chemistry=fastjx_prescutoff: 'fastjx' ;
       =namelist:chemistry=fastjx_dir: 'fastjx' ;
       =namelist:chemistry=fjx_scat_file: 'fastjx' ;
       =namelist:chemistry=fjx_solcyc_type: 'fastjx' ;
       =namelist:chemistry=fjx_spec_file: 'fastjx' ;
value-titles=Off,Prescribed,FastJX
values='off','prescribed','fastjx'

[namelist:chemistry=top_bdy_opt]
compulsory=true
description=Select method of treating top boundary for selected species
!enumeration=true
help=Options: Do nothing specific at the top,
    = Overwrite top 2 levels with 3rd-highest level for all species except H2O,
    = Overwrite top level with 2nd-highest level for all species,
    = Impose top boundary condition derived from ACE-FTS for NO, CO, O3,
    = Impose top boundary condition derived from ACE-FTS for NO, CO, O3, H2O.
ns=namelist/Science/UM Chemistry
sort-key=Panel-A05
value-titles=Do not overwrite, Overwrite top 2 levels (except H2O),
            = Overwrite only top level, Overwrite NO CO & O3 top level,
            = Overwrite NO CO O3 and H2O top level
values='no_overwrt', 'overwrt_top_two_lev', 'overwrt_only_top_lev',
      ='overwrt_co_no_o3_top', 'overwrt_co_no_o3_h2o_top'
