#==============================================================================
# BOUNDARY LAYER:
#==============================================================================

[namelist:blayer]
compulsory=true
description=Boundary layer parametrization
ns=namelist/Science/UM Boundary layer
sort-key=Section-A04
title=Boundary layer

[namelist:blayer=a_ent_2]
compulsory=true
description=Empirical constant multiplying buoyancy reversal entrainment term
help=The entrainment parametrization includes a term dependent on the
    =strength of any negative buoyancy generated through evaporative cooling
    =on mixing between cloudy boundary layer air and cloud-free air entrained
    =from above the boundary layer.  LES studies suggest a value 0.056.
!kind=default
ns=namelist/Science/UM Boundary layer
range=0.0:1.0
sort-key=Panel-A08a
type=real

[namelist:blayer=a_ent_shr]
compulsory=true
description=Empirical constant multiplying ustar entrainment term
help=The entrainment parametrization includes a term dependent on the
    =friction velocity (ustar). The constant of proportionality had
    =been 5.0 but the LES of Beare (2008) together with UKV case
    =studies suggest a lower value would be more appropriate
    =(Beare gives 1.6).
!kind=default
ns=namelist/Science/UM Boundary layer
range=0.0:10.0
sort-key=Panel-A08
type=real

[namelist:blayer=bl_levels]
description=Number of boundary layer levels
help=Typically only the levels in the lowest few kilometres of the
    =atmosphere are passed to the boundary layer scheme,
    =in order to save on
    =CPU time.  Depending on the choices in the Boundary Layer panel,
    =the
    =local scheme can be applicable to mixing processes in the free atmosphere
    =above the boundary layer.
!kind=default
ns=namelist/Science/UM Boundary layer
range=1:
sort-key=Panel-A01
type=integer

[namelist:blayer=bl_mix_w]
compulsory=true
description=Allow BL scheme to mix vertical velocity
help=Typically this is used in convective scale applications when horizontal
    =mixing via the Smagorinsky scheme is also included.
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A13
type=logical

[namelist:blayer=bl_res_inv]
compulsory=true
description=Select method for representing flux across partly resolved inversions
!enumeration=true
help=When selected the thickness of the capping inversion is diagnosed
    =and if it is thick enough to be partly resolved by the vertical grid,
    =the turbulent fluxes across the top of the boundary layer are applied
    =across the layers within the inversion via the boundary layer diffusion
    =coefficients. Two options are available for how to calculate this flux.
    =Either a specified cosine shape is used or else the flux is that
    =required to bring the theta_vl profile to a target piecewise linear shape.
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A15
value-titles=None,Use a cosine flux profile,
            =Use a target theta_vl profile
values='off','cosine_inv_flux','target_inv_profile'

[namelist:blayer=c_gust]
compulsory=true
description=Constant in the wind gust diagnostic
help=Tunable parameter used in the calculation of the wind gust.
    =For many years this was set to 4.0 but a value of 3.14 is
    =more approriate.  This affects both forms of the wind gust
    =diagnostics, wind_gust and scale_dep_wind_gust.
!kind=default
ns=namelist/Science/UM Boundary layer
range=0.0:10.0
sort-key=Panel-A02b
type=real

[namelist:blayer=cbl_mix_fac]
compulsory=true
description=Parameter to control convective BL stability function
help=Parameter to control mixing from the Ri-based scheme in convective
    =boundary layers, varying from 'Conventional' (0.0) to 'Standard' (1.0)
    =LEM functions
!kind=default
ns=namelist/Science/UM Boundary layer
range=0.0:1.0
sort-key=Panel-A02a
type=real

[namelist:blayer=cbl_opt]
compulsory=true
description=Convective BL stability function
!enumeration=true
help=Three options are available for the stability functions for unstable
    =(negative) Richardson numbers: those described as the "standard" and
    ="conventional" subgrid models in the LES of Brown (1999), and an option
    =to adjust between the previous two using a parameter 'cbl_mix_fac'.
    =The conventional model gives significantly less mixing than the standard.
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A02
trigger=namelist:blayer=cbl_mix_fac: 'adjustable';
value-titles=Conventional LEM,Standard LEM,Adjustable LEM
values='conventional','standard','adjustable'

[namelist:blayer=dec_thres_cloud]
compulsory=true
description=Decoupling threshold for cloudy boundary layers
help=This is recommended to be set to 0.1
!kind=default
ns=namelist/Science/UM Boundary layer
range=0.0:1.0
sort-key=Panel-A11a
type=real

[namelist:blayer=dec_thres_cu]
compulsory=true
description=Decoupling threshold for cumulus
help=This is recommended to be set to 0.05
!kind=default
ns=namelist/Science/UM Boundary layer
range=0.0:1.0
sort-key=Panel-A11b
type=real

[namelist:blayer=dyn_diag]
compulsory=true
description=Shear driven BL diagnosis options
!enumeration=true
help=In situations where surface conditions are close to neutral and the
    =land fraction is less than a half,
    =the thermodynamic parcel ascent diagnosis of both cumulus and
    =non-local boundary layers are over-ruled to leave turbulent mixing
    =to be determined by the local Richardson number scheme only.
    ="zi/L used over sea" gives problems when BL_LEVELS is high,
    =therefore "zi/L revised over sea" corrects this.
    ="zi/L used in Cumulus over sea" applies this only to points
    =diagnosed with Cumulus and strictly for sea points (fland<0.01,
    =cf 0.5).
    ="Ri based" also overrides Cumulus diagnosis if
    =Zh(Ri) > Zlcl+zhloc_depth_fac*(Zhpar-Zlcl).
    =Note that here Ri accounts for gradient adjustment by the
    =non-local scheme. This option further restricts a Cumulus diagnosis
    =to allow for disruption of cumulus formation through vertical wind
    =shear (diagnosed through a sub-critical Richardson number profile
    =extending well into the cloud layer). Under these circumstances the
    =non-local boundary layer scheme is allowed to mix up to the original
    =parcel ascent top.
    =
    =Additionally,
    =for all options (other than 0) the consistency of the provisional
    =diagnosis of an unstable boundary layer in CONV_DIAG is checked
    =against the surface flux diagnosed by the surface exchange routines.
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A09
trigger=namelist:blayer=zhloc_depth_fac: 'ri_based';
value-titles=zi/L revised over sea,zi/L used in Cumulus over sea,Ri based
values='zi_l_sea','zi_l_cu','ri_based'

[namelist:blayer=dzrad_disc_opt]
compulsory=true
description=Cloud-top radiatively-cooled layer discretization options
!enumeration=true
help=The buoyancy-flux integration used to find the depth of mixing in
    =stratocumulus layers is sensitive to the assumed depth of the cloud-top
    =radiative cooling.  However, this layer is often poorly resolved
    =in the vertical, and there are options for how to treat it when it
    =is too shallow to represent well on the grid:
    =1) Set the base of the radiatively-cooled layer to be at theta-level
    =   nt - 1. Note that the top of the layer (the Sc-top) is allowed
    =   to vary continuously between model-levels (from rho-level nt+1
    =   to rho-level nt+2).  So this option makes the depth vary between
    =   1.5 and 2.5 model-levels deep, with a sudden jump when the Sc-top
    =   passes a rho-level and nt jumps up.
    =2) Set the base of the radiatively-cooled layer to be 1.5 model-levels
    =   below the accurate Sc-top (interpolating smoothly between the
    =   model-level heights).
    =
    = Both of these options satisfy a requirement that the base of the
    = cloud-top layer falls below theta-level nt (otherwise vertical
    = gradients used in the buoyancy flux integration are ill-defined).
    = Under both options, the layer depth is subsequently increased up to
    = at least 100m (or the base of the cloud) if it is shallower than that.
    = Option 2 also includes any SL and qw gradients occuring within the
    = radiatively-cooled layer when calculating the buoyancy-flux
    = integrated over it (these are ignored in option 1).
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A10
value-titles=1) Set base of layer at theta-level nt-1,
            =2) Set base of layer smoothly 1.5 model-levels below cloud-top
values='level_ntm1','smooth_1p5'

[namelist:blayer=entr_smooth_dec]
compulsory=true
description=Smoothly reduce surface-driven entrainment when decoupling
!enumeration=true
help=Reduce the surface-driven contribution to cloud-top entrainment
    =smoothly as the strength of the decoupling grows (currently linearly
    =dependent on the "svl" difference between cloud and sub-cloud layers
    =in the range 0.5 to 1K.
    =The second option also smoothly reduces the height-scale used to
    =compute w* (which scales the surface-driven non-local mixing) from the
    =Sc-top height to the SML-top height as a function of decoupling strength.
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A10
value-titles=Off,
            =Smoothly taper surface entrainment terms,
            =Also smoothly blend from zh to zhsc in w*
values='off','on','taper_zh'

[namelist:blayer=flux_bc_opt]
compulsory=true
description=Surface flux production
!enumeration=true
help=This switch allows the user to specify the surface fluxes and/or surface
    =stresses as follows:
    =
    =  'interactive' Interactive fluxes calculated by JULES
    =  'specified_scalars' Specified scalar fluxes (sensible and latent heat)
    =    that are then calculated explicitly (this option is not recommended
    =    with interactive radiation because Tstar for upward LW is estimated)
    =    Fluxes are specified in namelist:specified_surface=function_name_fluxes.
    =  'specified_scalars_tstar' As above but with prescribed surface temperature.
    =  'specified_tstar' Specified surface temperatures, but not surface scalar fluxes
    =    Temperatures are specified in namelist:specified_surface=function_name_sst.
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A01
trigger=namelist:specified_surface=function_name_fluxes: 'specified_scalars','specified_scalars_tstar';
       =namelist:specified_surface=function_name_sst: 'specified_scalars_tstar', 'specified_tstar';
value-titles=Interactive fluxes, Specified scalar fluxes only, Specified scalar fluxes and surface temperature,
            =Specified surface temperature
values='interactive','specified_scalars','specified_scalars_tstar','specified_tstar'

[namelist:blayer=free_atm_mix]
compulsory=true
description=Free atmospheric turbulent mixing option
!enumeration=true
help=Relax to SHARPEST: the stable stability function requested relaxes
    =towards the "SHARPEST" function with height above the surface,
    =with a fixed height scale of 1km. If "Do not reduce mixing lengths
    =above the BL top" is selected this option will also smoothly merge
    =to the asymptotic mixing length by 3km above the surface.
    =
    =Corrected NTML is as the original but corrects the level
    =(ntml_local) below which the boundary layer value is used.
    =The final option extends this version to use interactively diagnosed
    =turbulent layer depths throughout the atmospheric column.
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A05
value-titles=Relax to SHARPEST,Original with corrected NTML,
            =Original with diagnosed turbulent layer depths
values='to_sharp','ntml_corrected','free_trop_layer'

[namelist:blayer=fric_heating]
compulsory=true
description=Apply heating source from turbulence dissipation
help=The drag on the resolved scale flow exerted by the boundary layer
    =turbulence parametrization should ultimately be dissipated as heat
    =but unless this option is selected this heating is ignored. It is
    =recommended to be implemented in all model versions.
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A04
type=logical

[namelist:blayer=interp_local]
compulsory=true
description=Choice of interpolation method for buoyancy gradient in Ri
!enumeration=true
help=Due to the winds and scalar fields being on staggered vertical grids,
    =vertical interpolation is required to calculate the local turbulent
    =diffusivity (as a function of shear and static stability).
    =There are multiple options for the order of calculation / which
    =fields to interpolate:
    =  1) Interpolate the vertical gradients of sl,qw from their native
    =     rho-levels to theta-levels, and calculate stability, dbdz, and Kh
    =     on theta-levels.
    =     This has the advantage that the stability calculation can
    =     use the cloud-fraction on its native grid.  But a disadvantage
    =     is that, since the gradients have to be interpolated,
    =     sharp changes in qw in cloud-free air above cloud-top inversions
    =     get multiplied by the in-cloud buoyancy coefficients.
    =     This can lead to arguably spurious instability at cloud-top
    =     and hence large fluxes through cloud-capping inversions.
    = 2)  Calculate stability, dbdz, on rho-levels where the gradients of
    =     sl,qw are defined (using an interpolated cloud-fraction),
    =     and then interpolate dbdz onto theta-levels to calculate Kh.
    =     This avoids the problem with option (1) at cloud-top inversions,
    =     but introduces additional complexity regarding how to
    =     interpolate the cloud-fraction onto rho-levels.  The method used
    =     is to estimate the volume fraction of the rho-level that is
    =     saturated, based on the cloud-fractions at the neighbouring
    =     theta-levels, combined with the gradient of total-water
    =     supersaturation qw - qsat(Tl) between the two levels.
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A04
value-titles=Interpolate sl and qw gradients to compute dbdz on theta-levels,
            =Compute dbdz on rho-levels and then interpolate to theta-levels
values='gradients','cf_dbdz'

[namelist:blayer=kprof_cu]
compulsory=true
description=Switch for non-local mixing across the LCL in cumulus
!enumeration=true
help=When this option is not used, a diagnosis of a cumulus regime means
    =that BL mixing is cut-off at the LCL leaving the convection scheme
    =to couple the cloud and sub-cloud layers.
    =The main advantages of using the BL scheme to couple the layers are
    =that it is diffusive and the solution is implicit.  Thus it responds
    =more effectively to processes acting to cause the layers to diverge.
    =Essentially two methods of generating the BL diffusion coefficients
    =across the LCL in cumulus are available, although using the buoyancy
    =flux integration algorithm is currently recommended.  The less
    =restrictive  version of that allows the mixed layer top to be
    =below the LCL
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A11
value-titles=Use the buoyancy flux integration algorithm,
            =Use less restrictive buoyancy flux integration algorithm
values='buoy_integ','buoy_integ_low'

[namelist:blayer=l_converge_ga]
compulsory=true
description=Use gradient adjustment depth-dependence in b-flux integration
help=Improve accuracy of mixed-layer depths found via buoyancy-flux integration,
    =by accounting for sensitivity of gradient adjustment to the depth.
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A10
type=logical

[namelist:blayer=l_use_sml_dsc_fixes]
compulsory=true
description=Misc. fixes to surface and stratocumulus mixed layer diagnosis
help=This switch fixes, or mitigates, inadequacies in the original coding of
    =the diagnosis of “decoupling” (the vertical extent of the diffusion
    =profiles) by making a number of changes to the calculation of non-local
    =turbulent mixing, related to the surface and stratocumulus mixed layers,
    =and their coupling / decoupling:
    =a) Remove accidental adding on of a separately-calculated entrainment
    =   flux at the SML-top when already using buoyancy-flux integration to
    =   estimate the entrainment diffusivity
    =   (avoids double-counting the SML entrainment-flux under cumulus).
    =b) Don't turn on ksurf_iterate when the "well-mixed" test only confirms
    =   a diagnosed elevated DSC-layer should not be recoupled with the SML
    =   (caused some inconsistent setting of variables).
    =c) Include missing factor of von Karman's constant times rho in the
    =   surface-driven Kh profile where this is added onto the DSC top-driven
    =   Kh profile in the buoyancy-flux integration
    =   (caused inaccurate estimate of the buoyancy-flux integral used to
    =    find the SML-top height under coupled DSC-layers).
    =d) Close loop-hole in logic that allows highly stably-stratified
    =   cloudy layers to be suddenly mixed into the SML if a DSC-layer is
    =   pre-diagnosed above them
    =   (this was causing the code to skip a crucial test on whether the
    =    cloudy-layer up to parcel-top had too strong negative buoyancy-flux
    =    to be well-mixed).
    =e) When finding the max cloud-fraction at the top of a turbulent layer
    =   (SML or DSC) for the purpose of computing cloud-depth,
    =   buoyancy-reversal and other cloud-top properties,
    =   check at ntml+1 as well as ntml and ntml-1
    =   (original code missed instances where the inversion has nearly
    =    risen to the next level and ntml+1 is by-far the cloudiest level).
    =f) Use revised setting of SML / DSC variables under recoupling.
    =   The original version diagnoses where the DSC-layer has been recoupled
    =   with the SML based on whether the SML-top model-level was changed
    =   inside excf_nl_9c, but there are rare instances where this doesn't give
    =   the right answer and the SML and DSC variables get muddled.
    =   The new version is more fool-proof, using flags explicitly set
    =   to indicate what has happened inside excf_nl_9c.
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A10
type=logical

[namelist:blayer=near_neut_z_on_l]
compulsory=true
description=Threshold value of z/l below which to diagnose shear-driven BL
help=This is recommended to be set to 1.6
!kind=default
ns=namelist/Science/UM Boundary layer
range=0.0:10.0
sort-key=Panel-A09a
type=real

[namelist:blayer=new_kcloudtop]
compulsory=true
description=Use less level-dependent radiative flux jump calculation
help=This logical implements a new method to identify the cloud top in the
    =radiative flux profile that results in a radiative flux jump estimation
    = that has been found to be less resolution sensitive.
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A10
type=logical

[namelist:blayer=ng_stress]
compulsory=true
description=Options for the Brown and Grant (1997) non-local stress scheme
!enumeration=true
help=This switch allows the user to choose between different physics options
    =for the non-local stress profile of Brown and Grant (1997).
    =The options are:
    =1) BG97_limited, the Brown and Grant (1997) non-local stress profile
    =applied above the surface layer with a limit on the surface stress used
    =to scale the stress profile to avoid unphysical values,
    =2) BG97_original, the same as BG97_limited but with the stress profile
    =applied across the whole boundary layer (as originally defined by
    =Brown and Grant (1997)).
ns=namelist/Science/UM Boundary layer
value-titles=Limited stress applied above the surface layer,
            =Limited stress applied over full boundary layer depth
values='BG97_limited','BG97_original'

[namelist:blayer=noice_in_turb]
compulsory=true
description=Ignore cloud ice in the BL turbulence scheme
help=If enabled the BL scheme will ignore all cloud ice
    =(water content, qcf, and fraction, cff) in its conserved variables
    =and mixing calculations.  Specifically this includes:
    =1) the calculation of buoyancy
    =2) the calculation of saturated humidity
    =3) the definition of conserved variables
    =   (ie sL=T+gz/cp - Lv qcl and qT=qv+qcl)
    =To do so would effectively assume the timescales for ice freezing/melting
    =are slower than the turbulence timescales, which is true for larger
    =particles but perhaps less so for small crystals.
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A14
type=logical

[namelist:blayer=num_sweeps_bflux]
compulsory=true
description=Number of iterations used to converge buoyancy-flux criteria
help=The depth reached by Decoupled StratoCumulus mixing
    =(and the height reached by the Surface Mixed Layer under some regimes)
    =is determined by setting it such-that the vertical integral of
    =negative turbulent buoyancy-flux at the base of a DSC (or top of a SML)
    =equals a set small fraction of the integral of positive buoyancy-flux
    =within the DSC-layer (or SML).  The DSC-base or SML-top height satisfying
    =this criterion is found by repeatedly sub-dividing the interval between
    =one height that is too low and another that is too high into 4.
    =num_sweeps_bflux sets the number of times the sub-dividision is repeated,
    =and so determines the accuracy of the solution for the mixed-layer depths;
    =each additional iteration reduces the error by a factor of 4.
!kind=default
ns=namelist/Science/UM Boundary layer
range=3:12
sort-key=Panel-A10
type=integer

[namelist:blayer=p_unstable]
compulsory=true
description=Parameter for implicit solver in unstable BL column
help=Using 1.0 is recommended. In general,
    =the higher these values are,
    =the more stable the scheme becomes. However,
    =running with great nonlinear stability at an
    =area which is not required (where a weakly
    =nonlinear is problem is solved) results in lower accuracy.
!kind=default
ns=namelist/Science/UM Boundary layer
range=0.0:100.0
sort-key=Panel-A12
type=real

[namelist:blayer=reduce_fa_mix]
compulsory=true
description=Options for where to reduce the local diffusion coefficients
!enumeration=true
help=Switch to decide where to keep the diffusion coefficient calculated
    =by the local Richardson number scheme. It is found beneficial to avoid
    =spurious mixing across well-defined inversions,
    =particularly for stratocumulus-capped boundary layers,
    =by setting these to zero.
    =It can also be appropriate to remove this local mixing across the
    =lifting condensation level in cumulus-capped layers.
    =If the boundary layer mixing is blending with the Smagorinsky subgrid
    =turbulence scheme then the local coefficients are only reduced by
    =applying the 1D weighting function,
    =rather than set to zero.
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A06
value-titles=Reduce in the levels spanning inversions and the LCL in cumulus,
            =Reduce in the levels spanning inversions
values='inv_and_cu_lcl','inv_only'

[namelist:blayer=sbl_opt]
compulsory=true
description=Stable BL stability function
!enumeration=true
help=There are many options for stable stability function in the Richardson
    =number scheme that reflect the range of tunings used in operational models.
    =The potential functions in increasing order of mixing strength are:
    =LEM, SHARPEST, Meso, Louis and Long tails
    =although not all these options have been coded into the LFRic interface.
    =
    =The LEM stability functions (which shut down turblence completely at a
    =critical Ri=0.25) give a stability dependence more relevant to
    =large-eddy simulation.
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A03
value-titles=LEM,SHARPEST,SHARP-sea; Mes-land
values='lem','sharpest','sharp_sea_mes_land'

[namelist:blayer=sc_diag_opt]
compulsory=true
description=Options for diagnosing stratocumulus layers
!enumeration=true
help=This switch controls how the boundary-layer scheme decides which
    =level is the top of a stratocumulus layer
    =(where the Sc-top entrainment flux is applied).
    =The available options are:
    = 0) Original code: diagnose Sc based on svl gradient at non-cumulus points
    =     but set to the conv_diag parcel top at shallow cumulus points.
    = 1) As (0) but also set the Sc-top to the conv_diag parcel top at
    =     "deep" cumulus points.
    = 2) At all cumulus points, diagnose Sc-top based on max total-water RH
    =     instead of using the conv_diag parcel top.
    = 3) Diagnose Sc-top based on max total-water RH at all points
    =     instead of using the svl gradient.
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A10
value-titles=Original svl gradient and shallow Cu-top method,
            =Relax to use parcel top at all convection points,
            =Use max total-water RH method at convection points,
            =Use max total-water RH method at all points
values='orig','cu_relax','cu_rh_max','all_rh_max'

[namelist:blayer=sg_orog_mixing]
compulsory=true
description=Option for treating unresolved drainage flows
!enumeration=true
help=Drainage flows often form in hilly areas as the air near the surface
    =cools at night.  Where these flows are on scales too small to be
    =resolved their effects on vertical mixing (through induced wind shear)
    =should be included. Two independent methods to do this have been coded.
    =Currently these require the orographic stress (LAND_SURF panel) and GWD
    =schemes to be switched on in order to have the necessary ancillary
    =fields loaded. The subgrid shear options currently convert these into
    =a mean slope using an empirical relationship derived for the UKV only,
    =and so this is not recommended for any other model. These options
    =include the shear in the calculation of the Richardson number and
    =diffusion coefficients,
    =with an additional option to enhance the mixing lengths. The other
    =option is to relate the length of the SHARPEST tail to subgrid orography,
    =following McCabe and Brown (2007).
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A07
value-titles=None,Subgrid shear plus enhanced mixing lengths
values='none','shear_plus_lambda'

[namelist:blayer=zhloc_depth_fac]
compulsory=true
description=Fractional cloud height reached by local BL depth calculation
!kind=default
ns=namelist/Science/UM Boundary layer
range=0.0:1.0
sort-key=Panel-A09a
type=real
